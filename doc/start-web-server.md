<!-- This file was automatically generated by jinjaroot. Do not edit directly. See the .jinjaroot dir. -->
# field-slicer web server

Tested on Linux, should also run on macOS and Windows Subsystem for Linux.

## Prerequisites and kachery setup

It is recommended that you start with a fresh [conda](https://docs.conda.io/projects/conda/en/latest/) environment with Python 3.8 or higher. For example:

```bash
conda create -n field-slicer python=3.8
```

After activating the new environment (`conda activate field-slicer`), install the following prerequisite packages:

```bash
conda install nodejs -c conda-forge --repodata-fn=repodata.json
npm install -g serve
pip install field-slicer
```

Create a directory where temporary kachery files will be stored and set the KACHERY_STORAGE_DIR environment variable (if not set, `$HOME/kachery-storage` will be used):

```
# This should be the full path to an existing directory.
# For example, you could use: $HOME/kachery-storage
export KACHERY_STORAGE_DIR="your-chosen-tmp-file-directory" 
```

Ensure that this environment variable is set with each new terminal session by adding the above line to your ~/.bashrc file.

Open a new terminal and start a kachery-p2p daemon, selecting a node label for display purposes:

```
# Make sure you are in the conda environment created above
# and that the KACHERY_STORAGE_DIR env variable is set
kachery-p2p-start-daemon --label your-chosen-node-label
```

Keep this running. It allows communication between the Python script and the GUI. See below for more advanced configuration options, or see [kachery-p2p](https://github.com/flatironinstitute/kachery-p2p).

## Installing and running the app

Upgrade to the latest field-slicer (it may be worth restarting the kachery daemon in case updates have been made to the kachery-p2p package):

```
# In a different terminal from the kachery daemon
# Make sure you are in the conda environment created above
pip install --upgrade field-slicer
```

Now run the field-slicer service:

```
# Make sure you are in the conda environment created above
field-slicer
```

Open the web app in a browser at http://localhost:14101.



## Advanced kachery daemon configuration

You can also set the following optional environment variables

```bash
# KACHERY_P2P_API_PORT
# This should correspond to the port being used by the kachery-p2p daemon
# By default it is 14101
export KACHERY_P2P_API_PORT="<Port number used by kachery-p2p daemon>"

# KACHERY_P2P_API_HOST
# This should correspond to the host being used by the kachery-p2p daemon
# By default it is localhost
export KACHERY_P2P_API_HOST="<Host name used by kachery-p2p daemon>"
```

See [kachery-p2p](https://github.com/flatironinstitute/kachery-p2p)